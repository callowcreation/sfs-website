<section class="page-section">
    <app-section-header>Configuration</app-section-header>

    <ng-container *ngTemplateOutlet="legacy; context: {form: forms.appearance}"></ng-container>

    <ng-container *ngTemplateOutlet="form; context: {form: forms.appearance}"></ng-container>

    <form [formGroup]="forms.behaviour" (ngSubmit)="onSubmit(forms.behaviour)">
        <mat-divider class="card-divider"></mat-divider>
        <mat-expansion-panel hideToggle>
            <mat-expansion-panel-header>
                <mat-panel-title>
                    <div class="header">Behaviour</div>
                </mat-panel-title>
                <mat-panel-description>
                    Modify bot functionality.
                </mat-panel-description>
            </mat-expansion-panel-header>
            <mat-divider></mat-divider>
            <mat-checkbox class="form-fit-half" [checked]="forms.behaviour.value['auto-shoutouts']"
                formControlName="auto-shoutouts">Auto
                Shoutouts</mat-checkbox>
            <mat-checkbox class="form-fit-half" [checked]="forms.behaviour.value['badge-vip']"
                formControlName="badge-vip">Badge
                Vip</mat-checkbox>
            <mat-divider></mat-divider>
            <mat-card-title>Commands</mat-card-title>
            <mat-selection-list #commandsList formControlName="commands">
                <mat-list-option *ngFor="let command of commands" [value]="command" [disabled]="command == 'so'">
                    {{command}}
                </mat-list-option>
            </mat-selection-list>
            <mat-divider class="card-divider"></mat-divider>
            <div style="text-align: right; margin: 10px;">
                <button mat-raised-button type="submit" [disabled]="!forms.behaviour.valid"
                    color="primary">Update</button>
            </div>
        </mat-expansion-panel>
    </form>
    <form [formGroup]="forms.bits" (ngSubmit)="onSubmit(forms.bits)">
        <mat-divider class="card-divider"></mat-divider>
        <mat-expansion-panel hideToggle>
            <mat-expansion-panel-header>
                <mat-panel-title>
                    <div class="header">Bits</div>
                </mat-panel-title>
                <mat-panel-description>
                    Bits to move items.
                </mat-panel-description>
            </mat-expansion-panel-header>
            <mat-divider></mat-divider>
            <mat-checkbox class="form-fit" [checked]="forms.bits.value['enable-bits']"
                formControlName="enable-bits">Enable
                Bits</mat-checkbox>
            <mat-form-field class="form-fit" *ngIf="forms.bits.value['enable-bits'] === true">
                <mat-label>Select a Tier</mat-label>
                <mat-select formControlName="bits-tier">
                    <mat-option *ngFor="let option of options" [value]="option">
                        {{option}}
                    </mat-option>
                </mat-select>
            </mat-form-field>
            <div class="form-fit" *ngIf="forms.bits.value['enable-bits'] === true">
                <mat-label>Pin Days ({{forms.bits.value['pin-days']}} days)</mat-label>
                <mat-slider style="text-align: center; min-width: 95%;" min="1" max="5" step="1">
                    <input matSliderThumb formControlName="pin-days">
                </mat-slider>
            </div>
            <mat-divider class="card-divider"></mat-divider>
            <div style="text-align: right; margin: 10px;">
                <button mat-raised-button type="submit" [disabled]="!forms.bits.valid" color="primary">Update</button>
            </div>
        </mat-expansion-panel>
    </form>
</section>

<ng-template #legacy let-legacy="form">
    <div [ngStyle]="{'background-color': legacy.value['background-color'], 'color': legacy.value['color']}"
        style="margin: auto; height: 300px; width: 300px; margin-top: 20px; margin-bottom: 15px;">
        <header>
            <div class="container">
                <h2>Shoutouts for Streamers</h2>
            </div>
        </header>
        <ul class="items-list">
            <li *ngFor="let guest of guests" class="ng-star-inserted">
                <div>
                    <div class="item" title="naivebot" [ngStyle]="{'border-color': legacy.value['border-color']}">
                        <div class="item-image"><a target="_blank" href="https://www.twitch.tv/{{guest.login}}"><img
                                    src="{{guest.profile_image_url}}"></a>
                        </div>
                        <div class="item-info">
                            <div class="item-info-display_name">{{guest.display_name}}
                            </div>
                            <div class="item-info-description">{{guest.description}}</div>
                            <div class="item-info-posted_by ng-star-inserted"
                                [ngStyle]="{'background-color': legacy.value['background-color'], 'border-color': legacy.value['border-color']}">
                                {{guest.posted_by}}</div>
                        </div>
                    </div>
                </div>
            </li>
        </ul>
    </div>
</ng-template>

<ng-template #form let-form="form">
    <form [formGroup]="form">
        <mat-divider [ngStyle]="{'border-color': form.value['border-color']}" style="border-width: 3px;"></mat-divider>
        <mat-expansion-panel hideToggle
            [ngStyle]="{'color': form.value['color'], 'background-color': form.value['background-color']}">
            <mat-expansion-panel-header>
                <mat-panel-title>
                    <div class="header" [ngStyle]="{'color': form.value['color']}">Appearance</div>
                </mat-panel-title>
                <mat-panel-description [ngStyle]="{'color': form.value['color']}">
                    Click here to try out your branding colors.
                </mat-panel-description>
            </mat-expansion-panel-header>
            <mat-form-field class="form-fit-33">
                <mat-label>Font Color</mat-label>
                <input type="color" matInput name="color-font" formControlName="color" />
            </mat-form-field>
            <mat-form-field class="form-fit-33">
                <mat-label>Background Color</mat-label>
                <input type="color" matInput name="color-background" formControlName="background-color" />
            </mat-form-field>
            <mat-form-field class="form-fit-33">
                <mat-label>Border Color</mat-label>
                <input type="color" matInput name="color-borders" formControlName="border-color">
            </mat-form-field>
            <mat-divider class="card-divider"></mat-divider>
            <div style="text-align: left; margin: 10px;">
                <button mat-raised-button [disabled]="!form.valid" (click)="randomize()"
                    color="accent">Randomize</button>

                <button mat-raised-button [disabled]="!form.valid" (click)="reset()" color="primary"
                    style="float: right;">Reset</button>

                <button mat-raised-button type="submit" [disabled]="!form.valid" (click)="onSubmit(form)"
                    color="primary" style="float: right;">Update</button>
            </div>
        </mat-expansion-panel>
        <mat-divider [ngStyle]="{'border-color': form.value['border-color']}" style="border-width: 3px;"></mat-divider>
    </form>
</ng-template>